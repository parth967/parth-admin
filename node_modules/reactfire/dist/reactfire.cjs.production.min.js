"use strict";function e(e){if(e&&e.__esModule)return e;var r={};return e&&Object.keys(e).forEach((function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})})),r.default=e,r}Object.defineProperty(exports,"__esModule",{value:!0});var r,t=require("react"),n=require("rxfire/auth"),o=require("rxjs"),i=(r=require("firebase/app"))&&"object"==typeof r&&"default"in r?r.default:r,a=require("rxfire/database"),s=require("rxjs/operators"),u=require("rxfire/firestore"),c=require("rxfire/storage");function l(){return(l=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function f(e){var r;return new Proxy((function(t,n){r=B();var o=H(n),a=S(e,t||r);if(!a.hasValue&&o)throw a.firstEmission;if(!a.hasValue&&!o&&!i[e])throw new Error('ReactFire: "firebase/'+e+'" not found. Please import it in your component, or call preload'+(e.charAt(0).toUpperCase()+e.slice(1))+" and wait for it to resolve. ReactFire can only auto-import Firebase libraries if Suspense mode is enabled.");return i[e]}),{get:function(e,r){return e()[r]},apply:function(e,t,n){var o=e(n[0]).bind(t);return n[0]||(n[0]=r),o.apply(void 0,n)}})}var p=f("auth"),d=f("analytics"),b=f("database"),m=f("firestore"),h=f("functions"),g=f("messaging"),v=f("performance"),x=f("remoteConfig"),_=f("storage"),w=p,y=d,F=b,E=m,D=h,O=g,C=v,k=x,P=_;function j(e){return function(r){return S(e,r.firebaseApp,r.setup).toPromise()}}function S(r,t,n){void 0===n&&(n=function(){});var i=t;return Z(new o.Observable((function(t){(function(r){switch(r){case"analytics":return new Promise((function(r){r(e(require("firebase/analytics")))}));case"auth":return new Promise((function(r){r(e(require("firebase/auth")))}));case"database":return new Promise((function(r){r(e(require("firebase/database")))}));case"firestore":return new Promise((function(r){r(e(require("firebase/firestore")))}));case"functions":return new Promise((function(r){r(e(require("firebase/functions")))}));case"messaging":return new Promise((function(r){r(e(require("firebase/messaging")))}));case"performance":return new Promise((function(r){r(e(require("firebase/performance")))}));case"remoteConfig":return new Promise((function(r){r(e(require("firebase/remote-config")))}));case"storage":return new Promise((function(r){r(e(require("firebase/storage")))}))}})(r).then((function(){var e=i[r].bind(i);Promise.resolve(n(e)).then((function(){t.next(e),t.complete()}))})).catch((function(e){t.error(e),t.complete()}))})),"firebase-sdk:"+r+":"+i.name)}var A=j("auth"),I=j("analytics"),q=j("database"),R=j("firestore"),V=j("functions"),T=j("messaging"),N=j("performance"),L=j("remoteConfig"),U=j("storage"),M=t.createContext(void 0),Q=t.createContext(!1);function H(e){var r=t.useContext(Q);return void 0!==e?e:r}function B(){var e=t.useContext(M);if(!e)throw new Error("Cannot call useFirebaseApp unless your component is within a FirebaseAppProvider");return e}function W(e,r){if(!(e=e||p()))throw new Error("firebase.auth not found");var t="auth:user:"+e.app.name,o=n.user(e),i=e.currentUser;return(null==r?void 0:r.initialData)&&!i&&(i=r.initialData),$(t,o,l({},r,{initialData:i}))}function z(e,r,t){if(void 0===r&&(r=!1),!e)throw new Error("you must provide a user");return $("auth:idTokenResult:"+e.uid+":forceRefresh="+r,o.from(e.getIdTokenResult(r)),t)}function G(e){var r=e.fallback,n=e.children,o=e.requiredClaims,i=z(e.user,!1).data.claims,a={};return o&&Object.keys(o).forEach((function(e){o[e]!==i[e]&&(a[e]={expected:o[e],actual:i[e]})})),0===Object.keys(a).length?t.createElement(t.Fragment,null,n):t.createElement(t.Fragment,null,r)}var J=globalThis._reactFireDatabaseCachedQueries||[];function K(e){var r=J.findIndex((function(r){return r.isEqual(e)}));return r>-1?r:J.push(e)-1}globalThis._reactFireDatabaseCachedQueries||(globalThis._reactFireDatabaseCachedQueries=J);var X=function(e){var r,t;function n(r,t){var n;return(n=e.call(this)||this)._timeoutWindow=t,n._hasValue=!1,n._error=void 0,n._firstEmission=new Promise((function(e){return n._resolveFirstEmission=e})),n._innerObservable=r.pipe(s.tap((function(e){n._next(e)}),(function(e){n._error=e,n._resolveFirstEmission()})),s.catchError((function(){return o.empty()})),s.shareReplay(1)),n._warmupSubscription=n._innerObservable.subscribe(),n._timeoutHandler=setTimeout(n._reset,n._timeoutWindow),n}t=e,(r=n).prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t;var i,a=n.prototype;return a._next=function(e){this._hasValue=!0,this._value=e,this._resolveFirstEmission()},a._reset=function(){var e=this;this._warmupSubscription&&this._warmupSubscription.unsubscribe(),this._hasValue=!1,this._value=void 0,this._error=void 0,this._firstEmission=new Promise((function(r){return e._resolveFirstEmission=r}))},a._subscribe=function(e){return this._timeoutHandler&&clearTimeout(this._timeoutHandler),this._innerSubscriber=this._innerObservable.subscribe(e),this._innerSubscriber.add(this._reset)},(i=[{key:"hasValue",get:function(){return this._hasValue||!!this._error}},{key:"value",get:function(){if(this._error)throw this._error;return this._value}},{key:"firstEmission",get:function(){return this._firstEmission}},{key:"ourError",get:function(){return this._error}}])&&function(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(n.prototype,i),n}(o.Subject),Y=globalThis._reactFirePreloadedObservables||new Map;function Z(e,r){if(Y.has(r))return Y.get(r);var t=new X(e,3e4);return Y.set(r,t),t}function $(e,r,n){var o;if(void 0===n&&(n={}),!e)throw new Error("cannot call useObservable without an observableId");var i=Z(r,e),a=Object.keys(n).includes("initialData"),s=H(n.suspense);if(!i.hasValue&&!(null==(o=n)?void 0:o.initialData)&&!0===s)throw i.firstEmission;var u=t.useState((function(){return i.hasValue?i.value:n.initialData})),c=u[0],l=u[1];return t.useEffect((function(){var e=i.subscribe((function(e){l((function(){return e}))}),(function(e){throw e}));return function(){return e.unsubscribe()}}),[i]),{status:i.hasError?"error":i.hasValue||a?"success":"loading",hasEmitted:i.hasValue,isComplete:i.isStopped,data:c,error:i.ourError,firstValuePromise:i.firstEmission}}globalThis._reactFirePreloadedObservables||(globalThis._reactFirePreloadedObservables=Y);var ee=globalThis._reactFireFirestoreQueryCache||[];function re(e){var r=ee.findIndex((function(r){return r.isEqual(e)}));return r>-1?r:ee.push(e)-1}function te(e){var r=e.remoteConfig,t=e.key,n=e.getter;return new o.Observable((function(e){r.ensureInitialized().then((function(){e.next(n.bind(r)(t))}))}))}function ne(e,r){return te({remoteConfig:e,key:r,getter:e.getValue})}function oe(e,r){return te({remoteConfig:e,key:r,getter:e.getString})}function ie(e,r){return te({remoteConfig:e,key:r,getter:e.getNumber})}function ae(e,r){return te({remoteConfig:e,key:r,getter:e.getBoolean})}function se(e){return te({remoteConfig:e,key:"",getter:e.getAll})}function ue(e,r,t){var n,o=null==(n=(t=t||x())._storage)?void 0:n.appName,i=r(t,e);return $("remoteConfig:"+e+":"+r.name+":"+o,i)}function ce(e,r){return $("storage:downloadUrl:"+e.toString(),c.getDownloadURL(e),r)}function le(e){return e=l({},e,{storage:_()}),t.createElement(fe,Object.assign({},e))}function fe(e){var r=e.storage,n=e.storagePath,o=e.suspense,i=e.placeHolder,a=function(e,r){if(null==e)return{};var t,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r.indexOf(t=i[n])>=0||(o[t]=e[t]);return o}(e,["storage","storagePath","suspense","placeHolder"]),s={suspense:H(o)};if(!r)throw new Error("Storage was not passed to component INTERNALStorageImage. This should not be possible");var u=ce(r.ref(n),s),c=u.data;return"success"===u.status?(a.alt||""===a.alt||console.warn('No alt prop provided for StorageImage with storagePath "'+n+'"',"img elements must have an alt prop, either with meaningful text, or an empty string for decorative images"),t.createElement("img",Object.assign({src:c,alt:a.alt},a))):null!=i?i:t.createElement(t.Fragment,null,"''")}function pe(e,r){if("idField"===r||"initialData"===r||"suspense"===r)return e?e[r]:void 0;throw new Error('Field "'+r+'" is not a valid key in ReactFireOptions')}function de(e){return pe(e,"idField")}globalThis._reactFireFirestoreQueryCache||(globalThis._reactFireFirestoreQueryCache=ee),exports.AuthCheck=function(e){var r=e.fallback,n=e.children,o=e.requiredClaims,i=W(e.auth).data;return i?o?t.createElement(G,{user:i,fallback:r,requiredClaims:o},n):t.createElement(t.Fragment,null,n):t.createElement(t.Fragment,null,r)},exports.ClaimsCheck=G,exports.FirebaseAppProvider=function(e){var r=e.firebaseConfig,n=e.appName,o=e.suspense,a=t.useMemo((function(){if(e.firebaseApp)return e.firebaseApp;var o,a,s=i.apps.find((function(e){return e.name===(n||"[DEFAULT]")}));if(s){if(r&&((o=s.options)===(a=r)||[].concat(Object.keys(o),Object.keys(a)).every((function(e){return o[e]===a[e]}))))return s;throw new Error("Does not match the options already provided to the "+(n||"default")+" firebase app instance, give this new instance a different appName.")}if(!r)throw new Error("No firebaseConfig provided");return i.registerVersion("react",t.version||"unknown"),i.registerVersion("reactfire","3.0.0-rc.0"),i.initializeApp(r,n)}),[e.firebaseApp,r,n]);return t.createElement(M.Provider,{value:a},t.createElement(Q.Provider,Object.assign({value:null!=o&&o},e)))},exports.StorageImage=function(e){return t.createElement(e.storage?fe:le,Object.assign({},e))},exports.SuspenseWithPerf=function(e){var r,n=e.children,o=e.traceId,i=e.fallback;if(!e.firePerf){var a=B();N({firebaseApp:a}).then((function(e){return e()}))}var s=(null==(r=performance)?void 0:r.getEntriesByName(o,"measure"))||[],u="_"+o+"Start["+s.length+"]",c="_"+o+"End["+s.length+"]";return t.createElement(t.Suspense,{fallback:t.createElement((function(){return t.useLayoutEffect((function(){var e;return null==(e=performance)||e.mark(u),function(){var e,r;null==(e=performance)||e.mark(c),null==(r=performance)||r.measure(o,u,c)}}),[]),t.createElement(t.Fragment,null,i)}),null)},n)},exports.analytics=y,exports.auth=w,exports.checkIdField=de,exports.checkOptions=pe,exports.checkinitialData=function(e){return pe(e,"initialData")},exports.database=F,exports.firestore=E,exports.functions=D,exports.messaging=O,exports.performance=C,exports.preloadAnalytics=I,exports.preloadAuth=A,exports.preloadDatabase=q,exports.preloadFirestore=R,exports.preloadFirestoreDoc=function(e,r){var t=(null==r?void 0:r.firebaseApp)||B();return R({firebaseApp:t}).then((function(r){var n=e(r());return Z(u.doc(n),"firestore:doc:"+t.name+":"+n.path)}))},exports.preloadFunctions=V,exports.preloadMessaging=T,exports.preloadObservable=Z,exports.preloadPerformance=N,exports.preloadRemoteConfig=L,exports.preloadStorage=U,exports.preloadUser=function(e){var r=(null==e?void 0:e.firebaseApp)||B();return A({firebaseApp:r}).then((function(e){return Z(n.user(e()),"auth:user:"+r.name).toPromise()}))},exports.remoteConfig=k,exports.storage=P,exports.useAnalytics=d,exports.useAuth=p,exports.useDatabase=b,exports.useDatabaseList=function(e,r){return $("database:list:"+K(e),a.list(e),r)},exports.useDatabaseListData=function(e,r){var t=r?de(r):"NO_ID_FIELD";return $("database:listVal:"+K(e)+":idField="+t,a.listVal(e,t),r)},exports.useDatabaseObject=function(e,r){return $("database:object:"+e.toString(),a.object(e),r)},exports.useDatabaseObjectData=function(e,r){var t,n=r?de(r):"NO_ID_FIELD";return $("database:objectVal:"+e.toString()+":idField="+n,(t=n,a.object(e).pipe(s.map((function(e){return function(e,r){var t,n=e.snapshot.val();return"object"!=typeof n?n:l({},e.snapshot.val(),r?((t={})[r]=e.snapshot.key,t):null)}(e,t)})))),r)},exports.useFirebaseApp=B,exports.useFirestore=m,exports.useFirestoreCollection=function(e,r){return $("firestore:collection:"+re(e),u.fromCollectionRef(e),r)},exports.useFirestoreCollectionData=function(e,r){var t=r?de(r):"NO_ID_FIELD";return $("firestore:collectionData:"+re(e)+":idField="+t,u.collectionData(e,t),r)},exports.useFirestoreDoc=function(e,r){return $("firestore:doc:"+e.firestore.app.name+":"+e.path,u.doc(e),r)},exports.useFirestoreDocData=function(e,r){var t=r?de(r):"NO_ID_FIELD";return $("firestore:docData:"+e.firestore.app.name+":"+e.path+":idField="+t,u.docData(e,t),r)},exports.useFirestoreDocDataOnce=function(e,r){var t=r?de(r):"NO_ID_FIELD";return $("firestore:docDataOnce:"+e.firestore.app.name+":"+e.path+":idField="+t,u.docData(e,t).pipe(s.first()),r)},exports.useFirestoreDocOnce=function(e,r){return $("firestore:docOnce:"+e.firestore.app.name+":"+e.path,u.doc(e).pipe(s.first()),r)},exports.useFunctions=h,exports.useIdTokenResult=z,exports.useIsSuspenseEnabled=function(){var e=t.useContext(Q);return null!=e&&e},exports.useMessaging=g,exports.useObservable=$,exports.usePerformance=v,exports.useRemoteConfig=x,exports.useRemoteConfigAll=function(e,r){return ue(e,se,r)},exports.useRemoteConfigBoolean=function(e,r){return ue(e,ae,r)},exports.useRemoteConfigNumber=function(e,r){return ue(e,ie,r)},exports.useRemoteConfigString=function(e,r){return ue(e,oe,r)},exports.useRemoteConfigValue=function(e,r){return ue(e,ne,r)},exports.useStorage=_,exports.useStorageDownloadURL=ce,exports.useStorageTask=function(e,r,t){return $("storage:task:"+r.toString(),function(e){return new o.Observable((function(r){e.on("state_changed",(function(e){return r.next(e)}),(function(e){return r.error(e)}),(function(){return r.complete()}))}))}(e),t?t.initialData:void 0)},exports.useSuspenseEnabledFromConfigAndContext=H,exports.useUser=W,exports.version="3.0.0-rc.0";
//# sourceMappingURL=reactfire.cjs.production.min.js.map
